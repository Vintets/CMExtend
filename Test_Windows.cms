#name "Test_Windows"
// Author: Vint
// Version: 1.0.0 (05.10.2021)
// Скрипт для Clickermann v4.13.014

LOGCLEAR

// подключение CMTools_CMS:
//#include "CMTools_CMS.cms"
#include "CMTools\CMTools_CMS.cms"

//                              Настройки
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

// показывать окно лога. Глубина 0, 1, 2
$log = 2


//##############################################################################

WAITMS(300)
log_show()


$timer1 = $_ms

//--- Тестирование функций -----------------------------------------------------

//Получаем дескриптор окна (hWnd) по Заголовку/классу/координатам/размерам/активности

// https://autoit-script.ru/docs/intro/windowsadvanced.htm
// параметр $AI_title в функциях работы с окнами. Эти установки могут быть использованы, чтобы отличить окна по следующим свойствам:
//TITLE - Заголовок окна
//CLASS - Внутреннее название класса окна
//REGEXPTITLE -Заголовок окна с использованием регулярных выражений
//REGEXPCLASS - Название класса окна с использованием регулярных выражений
//LAST - Последнее окно, использованное в предыдущей команде
//ACTIVE - Текущее активное окно
//X \ Y \ W \ H - Координаты и размер окна
//INSTANCE - Номер экземпляра окна, если несколько окон соответствуют критерию поиска (отсчёт начинается с 1).
// [СВОЙСТВО1:Значение1; СВОЙСТВО2:Значение2; СВОЙСТВО3:Значение3]
// если "Значение" должно содержать символ ";", он должен быть продублирован

print("окно кликера")
CME_WinGetHandle("[TITLE:Clickermann_; W:310; H:194]", "") // окно кликера
print("$_hwnd_self ", $_hwnd_self, \n)  // для сравнения
//WAITMS(30)

print("активное окно")
CME_WinGetHandle("[ACTIVE]", "")          // активное окно
WAITMS(30)
print("")

print("окно Notepad++")
CME_WinGetHandle("[CLASS:Notepad++]", "")   // класс блокнот
WAITMS(30)
print("")


//CME_WinGetProcess("[CLASS:Notepad++]", "")
//print("")
//CME_WinGetProcessCM()
//print("")

CME_WinGetState("[TITLE:Clickermann_; W:310; H:194]", "")
print("")

CME_WinGetHandle("[TITLE:Clickermann_; W:310; H:194]", "")
$hwnd = $CME_return
print("поверх всех окон")
CME_WinSetOnTop($hwnd, 1)
print("прозрачность 200")
CME_WinSetTrans($hwnd, 200)
WAITMS(100)

// =============================================================================

print_timeaction("тест 1", $_ms - $timer1)
HALT

